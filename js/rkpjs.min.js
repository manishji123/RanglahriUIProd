const ACCORDIAN_ICON_CLASS="accordian-icon";class AccordianTagsProperties{constructor(t,a,e){return this.defaultProp=t,this.expandProp=a,this.collapseProp=e,this}}class AccordianTags{constructor(t,a){return this.mainTag=t,this.iconTag=a,this}}class TagProperties{constructor(t,a,e){return this.classList=t,this.styleMap=a,this.innerHtml=e,this}}const accordianProperties=new Map;function initializeAccordians(t,a){var e,i=document.getElementById(t).getElementsByClassName("rkp-accordion");for(e=0;e<i.length;e++)buildAccordianTag(i[e],a),i[e].addEventListener("click",function(){toggleAccordian(this)});var r=document.getElementById(t).getElementsByClassName("rkp-accordion-all");for(e=0;e<r.length;e++){r[e].setAttribute("currentState","collapse");var n=buildTag("span",new Map([["class",ACCORDIAN_ICON_CLASS]]),r[e]);updateAccordianProperties(r[e],n,getAccordianProperties(a).collapseProp),r[e].addEventListener("click",function(){toggleAll(a,this,n,i)})}}function getAccordianProperties(t){return accordianProperties.get(t)}function updateTagProperties(t,a){if(a&&t){if(a.classList&&(t.className+=" "+a.classList),a.styleMap)for(var[e,i]of a.styleMap)t.style[e]=i;a.innerHtml&&(t.innerHTML=a.innerHtml)}}function updateAccordianProperties(t,a,e){updateTagProperties(t,e.mainTag),updateTagProperties(a,e.iconTag)}function toggleAll(t,a,e,i){var r=a.getAttribute("currentState");if(r&&"collapse"===r){for(updateAccordianProperties(a,e,getAccordianProperties(t).expandProp),n=0;n<i.length;n++)expandAccordian(i[n]);a.setAttribute("currentState","expand")}else{var n;for(updateAccordianProperties(a,e,getAccordianProperties(t).collapseProp),n=0;n<i.length;n++)collapseAccordian(i[n]);a.setAttribute("currentState","collapse")}}function buildAccordianTag(t,a){t.setAttribute("sourcePage",a),updateAccordianProperties(t,buildTag("span",new Map([["class",ACCORDIAN_ICON_CLASS]]),t),getAccordianProperties(a).defaultProp);var e=document.getElementById(t.getAttribute("target-id"));e.style.overflow="hidden";var i=document.getElementById(e.id+"-Outer");i&&(i.classList.add("border"),i.classList.add("border-info"),i.style.overflow="hidden");var r=t.getAttribute("target-initial-display");void 0===r||"show"!==r?(collapseAccordian(t),t.setAttribute("disabled","disabled")):expandAccordian(t)}function toggleAccordian(t,a){a||(a=document.getElementById(t.getAttribute("target-id"))),"block"===a.style.display?collapseAccordian(t,a):expandAccordian(t,a)}function expandAccordianByTargetElement(t){var a='[target-id="'+t.id+'"]';expandAccordian(document.querySelector(a),t)}function expandAccordian(t,a){var e=t.getAttribute("target-id");a||(a=document.getElementById(e));var i=t.getElementsByClassName(ACCORDIAN_ICON_CLASS);updateAccordianProperties(t,i[0],getAccordianProperties(t.getAttribute("sourcePage")).expandProp),t.removeAttribute("disabled"),a.style.display="block"}function collapseAccordianByTargetElement(t){var a='[target-id="'+t.id+'"]';collapseAccordian(document.querySelector(a),t)}function collapseAccordian(t,a){a||(a=document.getElementById(t.getAttribute("target-id")));var e=t.getElementsByClassName(ACCORDIAN_ICON_CLASS);updateAccordianProperties(t,e[0],getAccordianProperties(t.getAttribute("sourcePage")).collapseProp),a.style.display="none"}accordianProperties.set("chart-page",new AccordianTagsProperties(new AccordianTags(new TagProperties("rkp-chart-accordion"),new TagProperties("float-left px-3",void 0,"")),new AccordianTags(new TagProperties(void 0,new Map([["backgroundColor","LightCyan"]])),new TagProperties(void 0,new Map([["color","blue"]]),"▼")),new AccordianTags(new TagProperties(void 0,new Map([["backgroundColor","Lavender"]])),new TagProperties(void 0,new Map([["color","black"]]),"►")))),accordianProperties.set("rkp-tutorial",new AccordianTagsProperties(new AccordianTags(new TagProperties(void 0),new TagProperties(void 0,void 0,"")),new AccordianTags(new TagProperties(void 0,void 0),new TagProperties(void 0,new Map([["color","black"]]),'<i class="fas fa-minus-square"></i>')),new AccordianTags(new TagProperties(void 0,void 0),new TagProperties(void 0,new Map([["color","black"]]),'<i class="fas fa-plus-square"></i>')))),function(){"use strict";function t(t,a){a.hashPrefix(""),t.when("/rkp-home",{templateUrl:"partials/rkp-home.html"}).when("/rkp-chart",{templateUrl:"partials/rkp-chart.html",controller:"CtrlRkpChart"}).otherwise({redirectTo:"/rkp-home"})}angular.module("rkpApp",["ngRoute","rkpServiceModule","rkpControllerModule","rkpDirectiveModule"]).config(t),t.$inject=["$routeProvider","$locationProvider"]}();const basicDetailColumns=[];function buildBasicDetailDiv(t,a,e,i){for(var r=buildTag("div",new Map([["class","w-100 h-100 px-0 py-0"]]),i),n=t.basicPanchangDetail,s=n.length,l=buildTag("tabe",new Map([["class","table-sm w-100 h-100","m-0","p-0"]]),r),o=0;o<s;o+=4){var d="border-bottom border-left border-right";0==o&&(d="border-top "+d),d="";for(var c=buildTag("tr",new Map([["class",d+" d-flex"]]),l),u=0;u<4&&s>o+u;u++){var h=n[o+u];buildTag("td",new Map([["class","border-0 text-right col-1"]]),c,"<strong>"+h.x+":</strong>");"",buildTag("td",new Map([["class"," text-left col-2"]]),c,h.y)}}return i?e(i)(a):i=r,i}function BirthChartRotartion(t){return this.ascCusp=t,this}function getCuspArray(){for(var t=[],a=1;a<=12;a++)t.push(a);return t}BirthChartRotartion.cuspArray=getCuspArray(),BirthChartRotartion.getNewMappedCuspsAfterRotation=function(t,a){var e=a-t;return e<0&&(e+=12),new Map(BirthChartRotartion.cuspArray.map(t=>[t+e>12?(t+e)%12:t+e,t]))},BirthChartRotartion.prototype.rotateChartData=function(t,a){return this.mappedCuspsAfterRotation=BirthChartRotartion.getNewMappedCuspsAfterRotation(this.ascCusp,a),t.cuspViewModals.map(t=>this.mapCuspViewModalWithNewCusp(t)),t.cuspViewModals.sort((t,a)=>t.cuspNum>a.cuspNum?1:-1),t.planets.map(t=>this.mapPlanetWithNewCusp(t)),this.ascCusp=a,this.mappedCuspsAfterRotation=null,t},BirthChartRotartion.prototype.mapPlanetWithNewCusp=function(t){return t.occCusp=this.getNewCusp(t.occCusp),t.d1Rasi=this.getNewCusp(t.d1Rasi),t.d1Nak=this.getNewCusp(t.d1Nak),t.d1Sub=this.getNewCusp(t.d1Sub),t.d1SSub=this.getNewCusp(t.d1SSub),t},BirthChartRotartion.prototype.mapCuspViewModalWithNewCusp=function(t){return t.cuspNum=this.getNewCusp(t.cuspNum),t},BirthChartRotartion.prototype.getNewCusp=function(t){if(t)return Array.isArray(t)?t.map(t=>this.mappedCuspsAfterRotation.get(t)):this.mappedCuspsAfterRotation.get(t)};class ChartDataDisplayCalculation{constructor(t,a,e){this.scope=t,this.ServiceRkpChart=a,this.compile=e,this.initialData(),this.chartDrawer=new ChartDrawer(400,250,t,e)}initialData(){var t=initialDataForChart;this.ServiceRkpChart.ayanamsas=t.ayanamsas,this.scope.ayanamsas=this.ServiceRkpChart.ayanamsas,this.ServiceRkpChart.countries=t.countries,this.scope.countries=this.ServiceRkpChart.countries;var a=t.states;this.scope.statesCountryMap=new Map,this.scope.statesCountryMap.set("IN",a),this.scope.birthChartFormFieldsstates=a,this.scope.transitstates=a}loadStates(t){var a=this.scope[t].country;if(a){this.scope.statesCountryMap||(this.scope.statesCountryMap=new Map);var e=this.scope.statesCountryMap.get(a);if(void 0===e){var i=this.ServiceRkpChart.fetchPlaceList(a);let r=this;i.then(function(i){e=i.data,r.scope.statesCountryMap.set(a,e),r.scope[t+"states"]=e,e&&(r.scope[t].state=e[0].x)}),this.removeUnusedStates()}else this.scope[t+"states"]=e,e&&(this.scope[t].state=e[0].x);this.scope[t+"cities"]=null}}removeUnusedStates(){var t=this.scope.statesCountryMap.keys(),a=[];this.scope.birthChartFormFields&&this.scope.birthChartFormFields.country&&a.push(this.scope.birthChartFormFields.country),this.scope.transit&&this.scope.transit.country&&a.push(this.scope.transit.country);for(let e of t)a.includes(e)||this.scope.statesCountryMap.delete(e)}searchCities(t){if(!this.validateCreateChartFormData(t,this.scope[t].citySearch,["citySearch"]))return;var a=this.ServiceRkpChart.searchCities(this.scope[t].citySearch,this.scope[t].country,this.scope[t].state);let e=this;a.then(function(a){a.status>=200&&a.status<=299?(e.scope[t+"cities"]=a.data,a.data&&(e.scope[t].city=a.data[0],e.setGeoBySelectedCity(t))):e.displayBirthChartError("birthChartFormFields",a,["citySearch"])})}setGeoBySelectedCity(t){var a=this.scope[t].city;if(a){var e=convertToDMS({longitude:a.y[1],latitude:a.y[0]});this.setGeoInForm(t,e.longitude,e.latitude,a.y[2])}}initBirthChartParameter(){buildChartform(document.getElementById("birthChartFormFieldsDiv"),this.scope,this.compile,"birthChartFormFields","createRangahriChart()"),this.scope.birthChartFormFields||(this.scope.birthChartFormFields={},this.setDateAndTimeInForm("birthChartFormFields"),this.setOtherParameterInBirthChartForm("birthChartFormFields","","birth",generateRandomInteger(1,249)),this.scope.birthChartFormFields.ayanamsa=this.ServiceRkpChart.defaultAyanamsa,this.scope.birthChartFormFields.country=this.ServiceRkpChart.defaultCountry,this.scope.birthChartFormFields.state=this.ServiceRkpChart.defaultState,this.scope.birthChartFormFields.isBhavaMadhya=!1)}initTransitParameter(){buildChartform(document.getElementById("transitFormFields"),this.scope,this.compile,"transit","getNativeTransit()"),this.scope.transit||(this.scope.transit={},this.setDateAndTimeInForm("transit"),this.scope.transit.ayanamsa=this.ServiceRkpChart.defaultAyanamsa,this.scope.transit.country=this.ServiceRkpChart.defaultCountry,this.scope.transit.state=this.ServiceRkpChart.defaultState),this.hideTransitformAyamansa()}setLocalGeoInForm(t){var a=getLocalLocationPositionPromise();let e=this;a.then(function(a){var i=convertToDMS(a.coords);e.setGeoInForm(t,i.longitude,i.latitude)});var i=getTimeZoneHour(new Date);this.scope[t].timezone=i,document.getElementById(t+"timezoneInput").value=i}setGeoInForm(t,a,e,i){this.scope[t].longitude=a,this.scope[t].latitude=e,document.getElementById(t+"longitudeInput").value=a,document.getElementById(t+"latitudeInput").value=e,i&&(this.scope[t].timezone=i,document.getElementById(t+"timezoneInput").value=i)}setDateAndTimeInForm(t,a){a||(a=new Date).setMilliseconds(0),document.getElementById(t+"dateInput").value=a,this.scope[t].date=a instanceof Date?a:new Date(a)}setBirthChartParameterFromFile(t){if(this.scope.birthParametersFile=t,this.scope.birthChartFormFields||(this.scope.birthChartFormFields={}),t){var a=t.name,e=new FileReader;e.readAsText(t,"UTF-8");let i=this;e.onload=function(t){const e=t.target.result.split(/\r\n|\n/);i.setGeoInForm("birthChartFormFields",e[2],e[3],e[1]),i.setDateAndTimeInForm("birthChartFormFields",e[0]),i.setOtherParameterInBirthChartForm("birthChartFormFields",a,e[4],e[5])},e.onerror=function(t){i.scope.fileContent="error"}}}setOtherParameterInBirthChartForm(t,a,e,i){a&&(a=a.replace(".rkp",""));var r=!(!e||"horary"!==e);document.getElementById(t+"nameInput").value=a,r?(document.getElementById(t+"birthChartRadio").getchecked=!1,document.getElementById(t+"horaryChartRadio").checked=!0):(document.getElementById(t+"birthChartRadio").checked=!0,document.getElementById(t+"horaryChartRadio").checked=!1),document.getElementById(t+"horaryNumberInput").value=i,this.scope[t].name=a,this.scope[t].isHorayChart=r,this.scope[t].horaryNumber=i}saveBirthChartFile(){var t=formatDate(this.scope.birthChartFormFields.date);t+="\n"+this.scope.birthChartFormFields.timezone,t+="\n"+this.scope.birthChartFormFields.longitude,t+="\n"+this.scope.birthChartFormFields.latitude,t+="\n"+(this.scope.birthChartFormFields.isHorayChart?"horary":"birth"),t+="\n"+this.scope.birthChartFormFields.horaryNumber;var a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",this.scope.birthChartFormFields.name+".rkp"),a.click()}hideTransitformAyamansa(){var t=this.ServiceRkpChart.getCachedChartData();if(t){var a=document.getElementById("transitayanamsaDiv");a&&(a.style.display="none",this.scope.transit.ayanamsa=t.nativeBirthDetail.ayanamsa)}}createBirthChart(){if(!this.validateCreateChartFormData("birthChartFormFields",this.scope.birthChartFormFields))return;var t={longitude:this.scope.birthChartFormFields.longitude,latitude:this.scope.birthChartFormFields.latitude,timezone:this.scope.birthChartFormFields.timezone,date:formatDate(this.scope.birthChartFormFields.date),name:this.scope.birthChartFormFields.name,chartType:this.scope.birthChartFormFields.isHorayChart?"horary":"birth",horaryNumber:this.scope.birthChartFormFields.horaryNumber,ayanamsa:this.scope.birthChartFormFields.ayanamsa,bhavaMadhya:this.scope.birthChartFormFields.isBhavaMadhya},a=this.ServiceRkpChart.creatNewChart(t);let e=this;a.then(function(t){t.status>=200&&t.status<=299?e.displayBirthChart(t.data):e.displayBirthChartError("birthChartFormFields",t)})}createChartForTransitDiv(t){var a,e;if(t)e=new Date(this.scope.dasaTransitDT);else{if(!this.validateCreateChartFormData("transit",this.scope.transit))return;e=this.scope.transit.date,a=this.scope.transit}a=this.buildTransitRequestData(e,a),this.clearTransitData();var i=this.ServiceRkpChart.creatNewChart(a);let r=this;i.then(function(i){i.status>=200&&i.status<=299?(r.ServiceRkpChart.setTransitData(i.data),r.clearTransitData(),r.fillTransitDiv(),t&&(r.scope.transit.date=e,r.scope.transit.timezone=a.timezone,r.scope.transit.longitude=a.longitude,r.scope.transit.latitude=a.latitude)):r.displayBirthChartError("transit",i)})}fillDasaTransitDiv(t){if(this.scope.dasaTransitDT&&document.getElementById("dasa_trasit_data-planets")&&this.scope.dasaTransitDT==t)return;var a=this.buildTransitRequestData(new Date(t)),e=this.ServiceRkpChart.creatNewChart(a);let i=this;e.then(function(a){i.clearDasaTransitData(),i.scope.dasaTransitDT=t,i.fillTransitPlanetDiv(document.getElementById("dasa_trasit_data"),a.data),i.fillTransitChartDiv(document.getElementById("dasa_trasit_charts"),a.data)})}validateCreateChartFormData(t,a,e){return BirthChartValidation.validateAndDisplayMessage(t,a,e)}displayBirthChart(t){this.ServiceRkpChart.setChartData(t),this.clearHoroscopeData(),this.fillHoroscopeData()}displayBirthChartError(t,a,e){if(422==a.status){var i=a.data.fieldErrors;BirthChartValidation.displayErrorMessages(t,i,e)}else a.status=400}buildTransitRequestData(t,a){var e,i,r=this.ServiceRkpChart.getCachedChartData();if(t&&(a||r))return r&&(e=r.cuspViewModals.map(function(t){return t.startDegree360}),a||(a=r.nativeBirthDetail),i=r.nativeBirthDetail.bhavaMadhya),{longitude:a.longitude,latitude:a.latitude,timezone:a.timezone,date:formatDate(t),name:"transit",chartType:"transit",ayanamsa:a.ayanamsa,cuspDegrees:e,bhavaMadhya:i}}fillHoroscopeData(){var t=document.getElementById("birthChartFormDiv");this.ServiceRkpChart.getCachedChartData()?(this.fillBasicBirthChartDetailDiv(),this.fillCompleteChartRotationDiv(),this.fillBirthChartDiv(),this.fillDivisionalChartDiv(),this.fillDasaDiv(),collapseAccordianByTargetElement(t),this.hideTransitformAyamansa()):expandAccordianByTargetElement(t)}fillBasicBirthChartDetailDiv(){var t=document.getElementById("birthChartPanchangDetailDiv");buildBasicDetailDiv(this.ServiceRkpChart.getCachedChartData(),this.scope,this.compile,t)}clearBasicBirthChartDetailDiv(){document.getElementById("birthChartPanchangDetailDiv").innerHTML=""}fillCompleteChartRotationDiv(){this.ServiceRkpChart.birthChartRotartion=new BirthChartRotartion(1),this.scope.cuspArray=BirthChartRotartion.cuspArray,this.scope.birthChartAscCusp=this.ServiceRkpChart.birthChartRotartion.ascCusp,buildChartRoationDiv(document.getElementById("birthChartRotationDiv"),this.scope,this.compile,"birthChart")}fillBirthChartDiv(){var t=this.ServiceRkpChart.getCachedChartData();if(t){this.scope.horoscopeCreated=!0,expandAccordianByTargetElement(document.getElementById("rkp_charts"));var a=document.getElementById("kp_charts");expandAccordianByTargetElement(a);var e=buildTag("div",void 0,a);this.chartDrawer.buildKPCharts(e,t);var i=buildTag("div",new Map([["class","py-1 px-0"]]),a),r=buildTag("div",void 0,i);new PlanetTable(this.scope,this.ServiceRkpChart).build(r,t.planets);var n=buildTag("div",void 0,a);new CuspTable(this.scope,this.ServiceRkpChart).build(n,t.cuspViewModals);var s=document.getElementById("dmatrix_data");expandAccordianByTargetElement(s),buildDestinyMatrixTable(s,t.planets)}}fillDivisionalChartDiv(){var t=this.ServiceRkpChart.getCachedChartData();if(t){var a=document.getElementById("divisional_charts");expandAccordianByTargetElement(a),this.chartDrawer.buildDivisionalCharts(a,t)}}fillDasaDiv(){var t=this.ServiceRkpChart.getCachedChartData();t&&(expandAccordianByTargetElement(document.getElementById("birthChartDasa")),buildMahaDasaTabulator(document.getElementById("mahadasas_data"),t.planets))}fillTransitDiv(){var t=this.ServiceRkpChart.getCachedChartData(),a=this.ServiceRkpChart.getCachedTransitData(),e=document.getElementById("transitChartFormDiv");if(a){expandAccordianByTargetElement(document.getElementById("transitChart"));var i=document.getElementById("transit_planet_data");if(expandAccordianByTargetElement(i),this.fillTransitPlanetDiv(i,a),t){var r=document.getElementById("transit_dmatrix");expandAccordianByTargetElement(r),buildTransitDestinyMatrixTable(r,t.planets,a.planets)}collapseAccordianByTargetElement(e)}else expandAccordianByTargetElement(e)}fillTransitPlanetDiv(t,a){var e=new PlanetTable(this.scope,this.ServiceRkpChart).build(t,a.planets);e.hideColumn("d1Rasi"),e.hideColumn("d1Nak"),e.hideColumn("d1Sub"),e.hideColumn("d1SSub"),e.hideColumn("d2Nak"),e.hideColumn("d2Rasi")}fillTransitChartDiv(t,a){var e={};e.planets=a.planets,e.cuspViewModals=this.ServiceRkpChart.getCachedChartData().cuspViewModals;var i={chartType:9};i.ascendentRasi=e.cuspViewModals[0].navamsa,i.rasiPlanets=groupByWithValue(a.planets,"navamsa","abbr"),this.chartDrawer.buildBasicCharts(t,e,void 0,i)}fillDetailedInternalDasaDiv(t,a,e){if(this.scope.currentInternalDasaStartDT&&document.getElementById("internaldasas_data-detailedDasa")&&this.scope.currentInternalDasaStartDT==a)return;var i=this.ServiceRkpChart.getDetailedDasa(t,a,e);let r=this;i.then(function(t){document.getElementById("internaldasas_data").innerHTML="",buildDetailedDasaTable(document.getElementById("internaldasas_data"),t.data[0]),r.scope.currentInternalDasaStartDT=a})}clearHoroscopeData(){this.clearBasicBirthChartDetailDiv(),this.clearChartRotationDiv(),this.clearBirthChartDiv(),this.clearDivisionalChartDiv(),this.clearDasaDiv(),this.clearTransitData(),this.ServiceRkpChart.setTransitData(null),expandAccordianByTargetElement(document.getElementById("birthChartFormDiv"))}clearChartRotationDiv(){this.ServiceRkpChart.birthChartRotartion=null,document.getElementById("birthChartRotationDiv").innerHTML=""}clearBirthChartDiv(){document.getElementById("planet_data"),document.getElementById("cusps_data");var t=document.getElementById("dmatrix_data"),a=document.getElementById("kp_charts");t.innerHTML="",a.innerHTML="",collapseAccordianByTargetElement(t),collapseAccordianByTargetElement(a),collapseAccordianByTargetElement(document.getElementById("rkp_charts"))}clearDivisionalChartDiv(){var t=document.getElementById("divisional_charts");t.innerHTML="",collapseAccordianByTargetElement(t)}clearDasaDiv(){document.getElementById("mahadasas_data").innerHTML="",document.getElementById("internaldasas_data").innerHTML="",this.clearDasaTransitData(),collapseAccordianByTargetElement(document.getElementById("birthChartDasa"))}clearDasaTransitData(){this.scope.dasaTransitDT=null,document.getElementById("dasa_trasit_data").innerHTML="",document.getElementById("dasa_trasit_charts").innerHTML=""}clearTransitData(){var t=document.getElementById("transit_dmatrix");collapseAccordianByTargetElement(t),t.innerHTML="";var a=document.getElementById("transit_planet_data");collapseAccordianByTargetElement(a),a.innerHTML="",expandAccordianByTargetElement(document.getElementById("transitChartFormDiv"))}resetValue(t,a){if(t&&a)for(var e=0;e<a.length;e++)if("horaryNumber"===a[e]){var i=generateRandomInteger(1,249);document.getElementById(t+"horaryNumberInput").value=i,this.scope[t].horaryNumber=i}else"geoCordinates"===a[e]?this.setLocalGeoInForm(t):"dateTime"===a[e]&&this.setDateAndTimeInForm(t)}birthChartRotate(){this.ServiceRkpChart.birthChartRotartion.ascCusp!==this.scope.birthChartAscCusp&&(this.ServiceRkpChart.birthChartRotartion.rotateChartData(this.ServiceRkpChart.getCachedChartData(),this.scope.birthChartAscCusp),this.clearBirthChartDiv(),this.clearTransitData(),this.clearDasaTransitData(),this.ServiceRkpChart.setTransitData(null),this.fillBirthChartDiv(),collapseAccordianByTargetElement(document.getElementById("divisional_charts")),console.log(this.scope.birthChartAscCusp))}rotateIndividualChart(t,a){this.chartDrawer.rotateIndividualChart(t,this.ServiceRkpChart.getCachedChartData(),a)}}function buildChartform(t,a,e,i,r){t&&t.classList.add("pt-2");var n=buildTag("form",new Map([["class","needs-validation"]]),t),s=buildTag("div",new Map([["class","col-md-10 border py-2"]]),n);if("birthChartFormFields"===i){var l=buildTag("div",new Map([["class","form-row pb-2 m-0 px-1"]]),s),o=buildTag("div",new Map([["class","form-check-inline"]]),l);buildTag("input",new Map([["id",i+"bhavaMadhyaChartRadio"],["type","radio"],["class","form-check-input"],["ng-model",i+".isBhavaMadhya"],["ng-value",!0]]),o),buildTag("label",new Map([["for",i+"bhavaMadhyaChartRadio"],["class","form-check-label"]]),o,"Bhava Madhya");var d=buildTag("div",new Map([["class","form-check-inline"]]),l);buildTag("input",new Map([["id",i+"placidousChartRadio"],["type","radio"],["class","form-check-input"],["ng-model",i+".isBhavaMadhya"],["ng-value",!1]]),d),buildTag("label",new Map([["for",i+"placidousChartRadio"],["class","form-check-label"]]),d,"Placidous")}var c=buildTag("div",new Map([["class","form-row pb-3 m-0"]]),s),u=buildTag("div",new Map([["id",i+"ayanamsaDiv"],["class","col-md-4"]]),c);if(buildTag("label",new Map([["for",i+"ayanamsaSelect"],["class","p-0 m-0 requiredFieldLabel"]]),u,"Ayanamsa"),buildTag("select",new Map([["id",i+"ayanamsaSelect"],["ng-options","o for o in ayanamsas"],["ng-model",i+".ayanamsa"],["class","custom-select form-control"]]),u),"birthChartFormFields"===i){var h=buildTag("div",new Map([["id",i+"chartTypeDiv"],["class","col-md-4 px-3"]]),c);buildTag("legend",new Map([["class","col-form-label p-0 m-0 requiredFieldLabel"]]),h,"Chart Type");var p=buildTag("div",new Map([["class","form-check"]]),h);buildTag("input",new Map([["id",i+"birthChartRadio"],["type","radio"],["class","form-check-input"],["ng-model",i+".isHorayChart"],["ng-value",!1]]),p),buildTag("label",new Map([["for",i+"birthChartRadio"],["class","form-check-label"]]),p,"Birth Chart");var m=buildTag("div",new Map([["class","form-check"]]),h);buildTag("input",new Map([["id",i+"horaryChartRadio"],["type","radio"],["class","form-check-input"],["ng-model",i+".isHorayChart"],["ng-value",!0]]),m),buildTag("label",new Map([["for",i+"horaryChartRadio"],["class","form-check-label"]]),m,"Horary Chart");var g=buildTag("div",new Map([["ng-show",i+".isHorayChart"],["class","col-md-4"]]),c);buildTag("label",new Map([["for",i+"horaryNumberInput"],["class","p-0 m-0 requiredFieldLabel"]]),g,"Horary Number");var y=buildTag("div",new Map([["id",i+"horaryNumberGrpDiv"],["class","input-group"]]),g);buildTag("input",new Map([["type","number"],["id",i+"horaryNumberInput"],["class","form-control"],["ng-model",i+".horaryNumber"],["min","1"],["max","249"]]),y);var b=buildTag("div",new Map([["class","input-group-append"]]),y);buildTag("button",new Map([["type","submit"],["ng-click",'resetValue("'+i+'", ["horaryNumber"])'],["class","btn btn-secondary btn-sm"]]),b,"Reset")}var C=buildTag("div",new Map([["class","form-row pb-3 m-0"]]),s);if("birthChartFormFields"===i){var v=buildTag("div",new Map([["id",i+"nameGrpDiv"],["class","col-md-6"]]),C);buildTag("label",new Map([["for",i+"nameInput"],["class","p-0 m-0 requiredFieldLabel"]]),v,"Name"),buildTag("input",new Map([["type","text"],["id",i+"nameInput"],["class","form-control"],["ng-model",i+".name"],["placeholder","Enter Name"]]),v)}var f=buildTag("div",new Map([["id",i+"dateGrpDiv"],["class","col-md-6"]]),C);buildTag("label",new Map([["for",i+"DateInput"],["class","p-0 m-0 requiredFieldLabel"]]),f,"Birth Date");var T=buildTag("div",new Map([["class","input-group"]]),f);buildTag("input",new Map([["type","datetime-local"],["id",i+"dateInput"],["step","1"],["ng-model",i+".date"],["class","form-control"]]),T);var x=buildTag("div",new Map([["class","input-group-append"]]),T);buildTag("button",new Map([["type","submit"],["ng-click",'resetValue("'+i+'", ["dateTime"])'],["class","btn btn-secondary btn-sm"]]),x,"Current");var w=buildTag("div",new Map([["class","form-row pb-3 m-0"]]),s),D=buildTag("div",new Map([["class","col-md-6"]]),w);buildTag("label",new Map([["for",i+"Country"],["class","p-0 m-0"]]),D,"Country"),buildTag("select",new Map([["id",i+"Country"],["ng-options","obj.x as obj.y for obj in countries"],["ng-model",i+".country"],["ng-change",'changeStates("'+i+'")'],["class","custom-select form-control"]]),D);var M=buildTag("div",new Map([["class","col-md-6"]]),w);buildTag("label",new Map([["for",i+"State"],["class","p-0 m-0"]]),M,"State"),buildTag("select",new Map([["id",i+"State"],["ng-options","obj.x as obj.y for obj in "+i+"states"],["ng-model",i+".state"],["class","custom-select form-control"]]),M);var S=buildTag("div",new Map([["class","form-row pb-3 m-0"]]),s),B=buildTag("div",new Map([["class","col-md-6"]]),S);buildTag("label",new Map([["for",i+"citySearch"],["class","p-0 m-0"]]),B,"Search City");var A=buildTag("div",new Map([["id",i+"citySearchGrpDiv"],["class","input-group"]]),B);buildTag("input",new Map([["type","text"],["id",i+"citySearchInput"],["ng-model",i+".citySearch"],["class","form-control"],["aria-describedby",i+"GeoHelpTextBlock"]]),A),buildTag("small",new Map([["id",i+"GeoHelpTextBlock"],["class","form-text text-info m-0 p-0"]]),B,"* Search and select city to populate geo coordinates & timezone");var R=buildTag("div",new Map([["class","input-group-append"]]),A);buildTag("button",new Map([["type","submit"],["ng-click",'searchCities("'+i+'")'],["class","btn btn-secondary btn-sm"]]),R,"Search");var P=buildTag("div",new Map([["class","col-md-6"]]),S);buildTag("label",new Map([["for",i+"City"],["class","p-0 m-0"]]),P,"Select City"),buildTag("select",new Map([["id",i+"City"],["ng-options","obj as obj.x for obj in "+i+"cities"],["ng-model",i+".city"],["ng-change",'setGeoBySelectedCity("'+i+'")'],["class","custom-select form-control"]]),P);var k=buildTag("div",new Map([["class","px-0 col-md-12"]]),s);buildTag("label",new Map([["for",i+"GeoBlock"],["class","p-0 m-0"]]),k,"Geo Coordinates & Timezone");var I=buildTag("div",new Map([["for",i+"GeoBlock"],["class","border pt-2 pb-0 m-0 px-3"]]),k),F=buildTag("div",new Map([["class","form-row p-0 m-0"]]),I),E=buildTag("div",new Map([["class","form-group col-md-12 py-0 my-0"]]),F);buildTag("button",new Map([["type","submit"],["id",i+"localGeoResetButton"],["ng-click",'resetValue("'+i+'", ["geoCordinates"])'],["class","btn btn-secondary btn-sm float-right"],["data-toggle","tooltip"],["data-placement","left"],["title","* Click to set the local geo coordinates and timezone"]]),E,"Local Geo & Timezone");var N=buildTag("div",new Map([["class","form-row p-0 m-0"]]),I),L=buildTag("div",new Map([["id",i+"longitudeGrpDiv"],["class","col-md-4"]]),N);buildTag("label",new Map([["for",i+"longInput"],["class","p-0 m-0 requiredFieldLabel"]]),L,"Longitude"),buildTag("input",new Map([["type","text"],["id",i+"longitudeInput"],["ng-model",i+".longitude"],["class","form-control"]]),L);var V=buildTag("div",new Map([["id",i+"latitudeGrpDiv"],["class","form-group col-md-4"]]),N);buildTag("label",new Map([["for",i+"latiInput"],["class","p-0 m-0 requiredFieldLabel"]]),V,"Latitude"),buildTag("input",new Map([["type","text"],["id",i+"latitudeInput"],["ng-model",i+".latitude"],["class","form-control"]]),V);var H=buildTag("div",new Map([["id",i+"timezoneGrpDiv"],["class","form-group col-md-4"]]),N);buildTag("label",new Map([["for",i+"tzInput"],["class","p-0 m-0 requiredFieldLabel"]]),H,"Timezone"),buildTag("input",new Map([["type","text"],["id",i+"timezoneInput"],["ng-model",i+".timezone"],["class","form-control"]]),H);var G=buildTag("div",new Map([["class","form-row pt-2"]]),n),z=buildTag("div",new Map([["class","form-group  px-2"]]),G);return buildTag("button",new Map([["type","submit"],["ng-click",r],["class","btn btn-success btn-lg"]]),z,"Create"),e(t)(a),t}function buildChartRoationDiv(t,a,e,i){var r=buildTag("div",new Map([["class","w-100 px-2 py-1"]]),t),n=buildTag("div",new Map([["class","w-100"],["id",i+"cuspRotationDiv"]]),r),s=buildTag("div",new Map([["class","form-row form-inline px-1"]]),n);buildTag("strong",new Map([["class","pr-5 pl-2"]]),s,"Horoscope Rotation : "),buildTag("label",new Map([["for",i+"cuspRotationSelect"],["class","px-1"]]),s,"Lagna(Ascendent Cusp): "),buildTag("select",new Map([["id",i+"cuspRotationSelect"],["ng-options","n for n in cuspArray"],["ng-model",i+"AscCusp"],["class","custom-select form-control"]]),s);var l=buildTag("div",new Map([["class","form-group  px-2"]]),s);return buildTag("button",new Map([["type","submit"],["ng-click",i+"Rotate()"],["class","btn btn-secondary"]]),l,"Go"),e(t)(a),t}var contextPath="";contextPath="https://api.ranglahri.com";const defaultCountry="IN";function ConrollerHelper(t,a,e){return this.scope=t,this.ServiceRkpChart=a,this.compile=e,this}function CuspTable(t,a){return this.scope=t,this.ServiceRkpChart=a,that=this,this}function buildMahaDasaTabulator(t,a){return new Tabulator(t,{layout:"fitData",headerSort:!1,resizableColumns:!1,movableRows:!1,movableColumns:!1,data:a,autoResize:!0,height:"570",columnMinWidth:120,initialSort:[{column:"dasa.startDT",dir:"asc"}],columns:[{title:"Maha Dasa",field:"dasa.startDT",formatter:function(t,a){return buildDasaButton(t.getRow().getData())}}]})}ConrollerHelper.prototype.bindChartDataDisplayCalls=function(t){this.bindBirthChartCalls(t),this.bindDasaCalls(t),this.bindTransitChartCalls(t)},ConrollerHelper.prototype.bindBirthChartCalls=function(t){t.initBirthChartParameter(),t.fillHoroscopeData(),this.scope.resetValue=function(a,e){t.resetValue(a,e)},this.scope.birthChartRotate=function(){t.birthChartRotate()},this.scope.readBirthChartParametersFile=function(a){t.setBirthChartParameterFromFile(a)},this.scope.createRangahriChart=function(){t.createBirthChart()},this.scope.saveBirthChartRkpFile=function(){setTimeout(function(){t.saveBirthChartFile()},500)},this.scope.changeStates=function(a){t.loadStates(a)},this.scope.searchCities=function(a){t.searchCities(a)},this.scope.setGeoBySelectedCity=function(a){t.setGeoBySelectedCity(a)},this.scope.rotateIndividualChart=function(a,e){t.rotateIndividualChart(a,e)}},ConrollerHelper.prototype.bindDasaCalls=function(t){this.scope.getDetailedInternalDasa=function(a,e,i){t.fillDetailedInternalDasaDiv(a,e,i)},this.scope.getDasaTransitData=function(a){t.fillDasaTransitDiv(a)}},ConrollerHelper.prototype.bindTransitChartCalls=function(t){t.initTransitParameter(),t.fillTransitDiv(),this.scope.getNativeTransit=function(){t.createChartForTransitDiv(!1)},this.scope.getNativeTransitFromDasa=function(){t.createChartForTransitDiv(!0)}},function(){"use strict";function t(t,a,e,i,r,n){a.isBhavaMadhya=!1;var s=new ChartDataDisplayCalculation(a,i,n);new ConrollerHelper(a,i,n).bindChartDataDisplayCalls(s)}angular.module("rkpControllerModule",[]).controller("CtrlRkpChart",t).controller("CtrlRkpHome",function(t,a,e,i,r){}),t.$inject=["$http","$scope","$log","ServiceRkpChart","$q","$compile"]}(),CuspTable.prototype.transposeData=function(t){var a=[];for(row of["cuspNum","sl","cuspPercentLength","cuspRasisHtml","cuspNaksHtml","ssl","badhakCuspNum"]){var e={};e._0=row;for(var i=0;i<t.length;i++)e["_"+(i+1)]=t[i][row];a.push(e)}return console.log(a),a},CuspTable.prototype.buildTranspose=function(t,a){var e=this.transposeData(a),i=new Tabulator(t,{layout:"fitData",resizableColumns:!1,columnHeaderVertAlign:"middle",movableRows:!0,movableColumns:!0,data:e,autoResize:!0,columns:[{title:"*",field:"_0",formatter:function(t,a){return t.getValue()}},{title:"1",field:"_1",formatter:function(t,a){return t.getValue()}},{title:"2",field:"_2",formatter:function(t,a){return t.getValue()}},{title:"3",field:"_3",formatter:function(t,a){return t.getValue()}},{title:"4",field:"_4",formatter:function(t,a){return t.getValue()}},{title:"5",field:"_5",formatter:function(t,a){return t.getValue()}},{title:"6",field:"_6",formatter:function(t,a){return t.getValue()}},{title:"7",field:"_7",formatter:function(t,a){return t.getValue()}},{title:"8",field:"_8",formatter:function(t,a){return t.getValue()}},{title:"9",field:"_9",formatter:function(t,a){return t.getValue()}},{title:"10",field:"_10",formatter:function(t,a){return t.getValue()}},{title:"11",field:"_11",formatter:function(t,a){return t.getValue()}},{title:"12",field:"_12",formatter:function(t,a){return t.getValue()}}]});return t.getElementsByClassName("tabulator-header")[0].style.height=0,i},CuspTable.prototype.build=function(t,a){return new Tabulator(t,{layout:"fitData",resizableColumns:!1,columnHeaderVertAlign:"middle",movableRows:!0,movableColumns:!0,data:a,autoResize:!0,columns:[{title:"Cusps Detail",columns:[{title:"*",field:"cuspNum",hozAlign:"right",formatter:function(t,a){return"<span style='color:red; font-weight:bold;'>"+t.getValue()+"</span>"},headerTooltip:"Cusp Number"},{title:"Deg",field:"degree",hozAlign:"right"},{title:"Rasi",field:"cuspRasisHtml",hozAlign:"right",sorter:function(t,a,e,i){return e.getData().startDegree360-i.getData().startDegree360}},{title:"Nak",field:"cuspNaksHtml",hozAlign:"right",sorter:function(t,a,e,i){return e.getData().startDegree360-i.getData().startDegree360}},{title:"D9",field:"navamsa",hozAlign:"center",headerTooltip:"Navamsa Rasi"},{title:"RL",field:"rl",hozAlign:"center",headerTooltip:"Rasi Lord"},{title:"NL",field:"nl",hozAlign:"center",headerTooltip:"Nakshatra Lord"},{title:"SL",field:"sl",hozAlign:"center",formatter:function(t,a){return"<span style='color:red; font-weight:bold;'>"+t.getValue()+"</span>"},headerTooltip:"Sub Lord"},{title:"SS",field:"ssl",hozAlign:"center",headerTooltip:"Sub-Sub Lord"}]}]})};var buildDasaButton=function(t){var a=t.dasa,e=document.createElement("button");e.id="maha-dasa-"+a.planet_number,e.innerHTML="<strong>"+a.startDT.substring(0,4)+" - "+a.endDT.substring(0,4)+"</strong>",e.classList.add("btn","btn-outline-primary","btn-sm"),e.onclick=function(t){buildDetailedDasa(t,a)};var i=document.createElement("span");return i.appendChild(document.createTextNode(a.name)),i.classList.add("dmatrix-planet-fullname-class"),i.appendChild(document.createElement("BR")),i.appendChild(e),i};function buildDetailedDasa(t,a){var e=t.currentTarget.id;angular.element(document.getElementById(e)).scope().getDetailedInternalDasa(a.planet_number,a.startDT,a.passed_years)}function buildDetailedDasaTable(t,a){var e=buildTag("div",new Map([["id",t.id+"-detailedDasa"]]),t),i=new Tabulator(e,{layout:"fitData",headerSort:!1,resizableColumns:!1,columnHeaderVertAlign:"middle",movableRows:!1,movableColumns:!1,data:a.internalDasa,dataTree:!0,dataTreeStartExpanded:!1,dataTreeChildField:"internalDasa",autoResize:!0,height:"570",columnMinWidth:75,columns:[{title:a.name,formatter:function(t,a){return t.getRow().getData().name.substring(0,2)}},{title:"From: "+a.startDT.substring(0,10),formatter:function(t,a){var e=t.getRow().getData();return buildDasaTransitLink(e.startDT.substring(0,19))}},{title:"To: "+a.endDT.substring(0,10),formatter:function(t,a){return t.getRow().getData().endDT.substring(0,19)}}]});return t.appendChild(e),i}var buildDasaTransitLink=function(t){var a=Math.random().toString(36).substr(2,9)+t,e=buildTag("button",new Map([["id",a],["class","btn btn-link btn-sm"]]),void 0,t);return e.onclick=function(a){buildDasaTransitData(a,t)},e};function buildDasaTransitData(t,a){var e=t.currentTarget.id;angular.element(document.getElementById(e)).scope().getDasaTransitData(a)}function buildTransitDestinyMatrixTable(t,a,e){for(var i=new Map(e.map(t=>[t.abbr,t])),r=0;r<9;r++){var n=i.get(a[r].abbr);n.d1Rasi=a[r].d1Rasi,n.d1Nak=a[r].d1Nak,n.d1Sub=a[r].d1Sub,n.d1SSub=a[r].d1SSub}var s=[[e[0],e[1],e[2]],[e[3],e[4],e[5]],[e[6],e[7],e[8]]],l=buildTag("div",new Map([["class","px-1 py-1"]]),t),o=buildTag("table",new Map([["class","dmatrix-table table-sm m-0 p-0"]]),l);buildHorizontalHeader(o);for(r=0;r<3;r++)buildDestinyMatrixSet(r,o,i,s[r],!0)}function buildDestinyMatrixTable(t,a){var e=new Map(a.map(t=>[t.abbr,t])),i=[[a[0],a[1],a[2]],[a[3],a[4],a[5]],[a[6],a[7],a[8]]],r=buildTag("div",new Map([["class","px-1 py-1"]]),t),n=buildTag("table",new Map([["class","dmatrix-table table-sm m-0 p-0"]]),r);buildHorizontalHeader(n);for(var s=0;s<3;s++)buildDestinyMatrixSet(s,n,e,i[s],!1)}function buildDestinyMatrixSet(t,a,e,i,r){return buildOneCompleteRow(t,"first",i,e,null,null,"PL","Planet",a,r),buildOneCompleteRow(t,"m-1",i,e,"nl",null,"NL","Nakshatra Lord",a,r),buildOneCompleteRow(t,"m-2",i,e,"sl",null,"SL","Sub Lord",a,r),buildOneCompleteRow(t,"last",i,e,"ssl",null,"SS","Sub-sub Lord",a,r),a}function buildOneCompleteRow(t,a,e,i,r,n,s,l,o,d){var c,u=document.createElement("tr");u.classList.add("dmatrix-rowblock-any-row-"+a),u.append(buildVerticalColumnHeader(s,l));for(var h=0;h<3;h++)null==r?c=e[h]:(c=i.get(e[h][r]),null!=n&&(c=i.get(c[n]))),buildOneRowForOneBlock(t,h,a,u,c,d);return"first"==a&&null==r&&(d||buildDasaCell(e,o)),o.appendChild(u),u}function buildOneRowForOneBlock(t,a,e,i,r,n){var s=buildTDWithText(r.abbr);n&&"first"==e?s.classList.add("dmatrix-planet-fullname-class"):s.classList.add("dmatrix-colblock-any-col-first"),i.appendChild(s),i.appendChild(buildTDWithText(r.occCusp)),i.appendChild(buildTDWithText(intArrToString(r.d1Rasi))),i.appendChild(buildTDWithText(intArrToString(r.d1Nak))),i.appendChild(buildTDWithText(intArrToString(r.d1Sub)));var l=buildTDWithText(intArrToString(r.d1SSub));return l.classList.add("dmatrix-colblock-any-col-last"),i.appendChild(l),i}function buildDasaCell(t,a){var e=document.createElement("tr");e.append(buildVerticalColumnHeader(""));for(var i=0;i<3;i++){var r=buildAgeTextButton(t[i]);r.colSpan="6",r.classList.add("dmatrix-colblock-any-col-last"),e.append(r)}a.appendChild(e)}function buildAgeTextButton(t){var a=t.dasa,e=buildTag("button",new Map([["id","dmatrix-dasa-"+a.planet_number],["class","btn btn-outline-secondary btn-sm disabled"]]),void 0,"<strong>Age : ("+t.ageDuringMD+")</strong>");e.onclick=function(t){buildDetailedDasa(t,a)};var i=document.createElement("td"),r=document.createElement("span");return r.innerHTML=a.name+t.retStr+"<sup style='color:red;'>"+getUntenantedSelfStarredStr(t)+"</sup> : ",i.appendChild(r),i.classList.add("dmatrix-planet-fullname-class"),i.appendChild(e),i}function buildHorizontalHeader(t){var a=document.createElement("tr");a.classList.add("dmatrix-row-header");var e=buildColumnHeaderWithText("");e.classList.add("dmatrix-colblock-header"),a.appendChild(e);for(var i=0;i<3;i++)a.appendChild(buildColumnHeaderWithText("")),a.appendChild(buildColumnHeaderWithText("C","Cusp Occupied")),a.appendChild(buildColumnHeaderWithText("R","Cusps by Rasi Lord")),a.appendChild(buildColumnHeaderWithText("N","Cusps by Nakshatra Lord")),a.appendChild(buildColumnHeaderWithText("S","Cusps by Sub Lord")),(e=buildColumnHeaderWithText("SS","Cusps by Sub-sub Lord")).classList.add("dmatrix-colblock-header"),a.appendChild(e);t.appendChild(a)}function buildVerticalColumnHeader(t,a){var e=buildColumnHeaderWithText(t,a);return e.classList.add("dmatrix-colblock-header"),e}function buildColumnHeaderWithText(t,a){var e=buildTDWithText(t,a);return e.classList.add("dmatrix-header-text"),e}function buildTDWithText(t,a){var e=document.createElement("td"),i=document.createElement("span");return i.textContent=t,void 0!==a&&a.length>0&&(i.setAttribute("data-toggle","tooltip"),i.setAttribute("data-placement","right"),i.setAttribute("title",a)),e.appendChild(i),e}!function(){"use strict";angular.module("rkpDirectiveModule",[]).directive("validFile",function(){return{require:"ngModel",scope:{format:"@",upload:"&upload"},link:function(t,a,e,i){a.bind("change",function(e){t.upload({file:e.target.files[0]}),t.$apply(function(){i.$setViewValue(a.val()),i.$render()})})}}})}();const initialDataForChart={ayanamsas:["Aryabhata","Aryabhata Msun","Fagan Bradley","Krishnamurti","Lahiri","Raman","Ss Citra","Ss Revati","Suryasiddhanta","Suryasiddhanta Msun","True Citra","True Pushya","True Revati","Ushashashi","Yukteshwar"],countries:[{x:"AF",y:"Afghanistan"},{x:"AX",y:"Aland Islands"},{x:"AL",y:"Albania"},{x:"DZ",y:"Algeria"},{x:"AS",y:"American Samoa"},{x:"AD",y:"Andorra"},{x:"AO",y:"Angola"},{x:"AI",y:"Anguilla"},{x:"AQ",y:"Antarctica"},{x:"AG",y:"Antigua and Barbuda"},{x:"AR",y:"Argentina"},{x:"AM",y:"Armenia"},{x:"AW",y:"Aruba"},{x:"AU",y:"Australia"},{x:"AT",y:"Austria"},{x:"AZ",y:"Azerbaijan"},{x:"BS",y:"Bahamas"},{x:"BH",y:"Bahrain"},{x:"BD",y:"Bangladesh"},{x:"BB",y:"Barbados"},{x:"BY",y:"Belarus"},{x:"BE",y:"Belgium"},{x:"BZ",y:"Belize"},{x:"BJ",y:"Benin"},{x:"BM",y:"Bermuda"},{x:"BT",y:"Bhutan"},{x:"BO",y:"Bolivia"},{x:"BQ",y:"Bonaire, Saint Eustatius and Saba "},{x:"BA",y:"Bosnia and Herzegovina"},{x:"BW",y:"Botswana"},{x:"BV",y:"Bouvet Island"},{x:"BR",y:"Brazil"},{x:"IO",y:"British Indian Ocean Territory"},{x:"VG",y:"British Virgin Islands"},{x:"BN",y:"Brunei"},{x:"BG",y:"Bulgaria"},{x:"BF",y:"Burkina Faso"},{x:"BI",y:"Burundi"},{x:"CV",y:"Cabo Verde"},{x:"KH",y:"Cambodia"},{x:"CM",y:"Cameroon"},{x:"CA",y:"Canada"},{x:"KY",y:"Cayman Islands"},{x:"CF",y:"Central African Republic"},{x:"TD",y:"Chad"},{x:"CL",y:"Chile"},{x:"CN",y:"China"},{x:"CX",y:"Christmas Island"},{x:"CC",y:"Cocos Islands"},{x:"CO",y:"Colombia"},{x:"KM",y:"Comoros"},{x:"CK",y:"Cook Islands"},{x:"CR",y:"Costa Rica"},{x:"HR",y:"Croatia"},{x:"CU",y:"Cuba"},{x:"CW",y:"Curacao"},{x:"CY",y:"Cyprus"},{x:"CZ",y:"Czechia"},{x:"CD",y:"Democratic Republic of the Congo"},{x:"DK",y:"Denmark"},{x:"DJ",y:"Djibouti"},{x:"DM",y:"Dominica"},{x:"DO",y:"Dominican Republic"},{x:"EC",y:"Ecuador"},{x:"EG",y:"Egypt"},{x:"SV",y:"El Salvador"},{x:"GQ",y:"Equatorial Guinea"},{x:"ER",y:"Eritrea"},{x:"EE",y:"Estonia"},{x:"SZ",y:"Eswatini"},{x:"ET",y:"Ethiopia"},{x:"FK",y:"Falkland Islands"},{x:"FO",y:"Faroe Islands"},{x:"FJ",y:"Fiji"},{x:"FI",y:"Finland"},{x:"FR",y:"France"},{x:"GF",y:"French Guiana"},{x:"PF",y:"French Polynesia"},{x:"TF",y:"French Southern Territories"},{x:"GA",y:"Gabon"},{x:"GM",y:"Gambia"},{x:"GE",y:"Georgia"},{x:"DE",y:"Germany"},{x:"GH",y:"Ghana"},{x:"GI",y:"Gibraltar"},{x:"GR",y:"Greece"},{x:"GL",y:"Greenland"},{x:"GD",y:"Grenada"},{x:"GP",y:"Guadeloupe"},{x:"GU",y:"Guam"},{x:"GT",y:"Guatemala"},{x:"GG",y:"Guernsey"},{x:"GN",y:"Guinea"},{x:"GW",y:"Guinea-Bissau"},{x:"GY",y:"Guyana"},{x:"HT",y:"Haiti"},{x:"HM",y:"Heard Island and McDonald Islands"},{x:"HN",y:"Honduras"},{x:"HK",y:"Hong Kong"},{x:"HU",y:"Hungary"},{x:"IS",y:"Iceland"},{x:"IN",y:"India"},{x:"ID",y:"Indonesia"},{x:"IR",y:"Iran"},{x:"IQ",y:"Iraq"},{x:"IE",y:"Ireland"},{x:"IM",y:"Isle of Man"},{x:"IL",y:"Israel"},{x:"IT",y:"Italy"},{x:"CI",y:"Ivory Coast"},{x:"JM",y:"Jamaica"},{x:"JP",y:"Japan"},{x:"JE",y:"Jersey"},{x:"JO",y:"Jordan"},{x:"KZ",y:"Kazakhstan"},{x:"KE",y:"Kenya"},{x:"KI",y:"Kiribati"},{x:"XK",y:"Kosovo"},{x:"KW",y:"Kuwait"},{x:"KG",y:"Kyrgyzstan"},{x:"LA",y:"Laos"},{x:"LV",y:"Latvia"},{x:"LB",y:"Lebanon"},{x:"LS",y:"Lesotho"},{x:"LR",y:"Liberia"},{x:"LY",y:"Libya"},{x:"LI",y:"Liechtenstein"},{x:"LT",y:"Lithuania"},{x:"LU",y:"Luxembourg"},{x:"MO",y:"Macao"},{x:"MG",y:"Madagascar"},{x:"MW",y:"Malawi"},{x:"MY",y:"Malaysia"},{x:"MV",y:"Maldives"},{x:"ML",y:"Mali"},{x:"MT",y:"Malta"},{x:"MH",y:"Marshall Islands"},{x:"MQ",y:"Martinique"},{x:"MR",y:"Mauritania"},{x:"MU",y:"Mauritius"},{x:"YT",y:"Mayotte"},{x:"MX",y:"Mexico"},{x:"FM",y:"Micronesia"},{x:"MD",y:"Moldova"},{x:"MC",y:"Monaco"},{x:"MN",y:"Mongolia"},{x:"ME",y:"Montenegro"},{x:"MS",y:"Montserrat"},{x:"MA",y:"Morocco"},{x:"MZ",y:"Mozambique"},{x:"MM",y:"Myanmar"},{x:"NA",y:"Namibia"},{x:"NR",y:"Nauru"},{x:"NP",y:"Nepal"},{x:"NL",y:"Netherlands"},{x:"AN",y:"Netherlands Antilles"},{x:"NC",y:"New Caledonia"},{x:"NZ",y:"New Zealand"},{x:"NI",y:"Nicaragua"},{x:"NE",y:"Niger"},{x:"NG",y:"Nigeria"},{x:"NU",y:"Niue"},{x:"NF",y:"Norfolk Island"},{x:"KP",y:"North Korea"},{x:"MK",y:"North Macedonia"},{x:"MP",y:"Northern Mariana Islands"},{x:"NO",y:"Norway"},{x:"OM",y:"Oman"},{x:"PK",y:"Pakistan"},{x:"PW",y:"Palau"},{x:"PS",y:"Palestinian Territory"},{x:"PA",y:"Panama"},{x:"PG",y:"Papua New Guinea"},{x:"PY",y:"Paraguay"},{x:"PE",y:"Peru"},{x:"PH",y:"Philippines"},{x:"PN",y:"Pitcairn"},{x:"PL",y:"Poland"},{x:"PT",y:"Portugal"},{x:"PR",y:"Puerto Rico"},{x:"QA",y:"Qatar"},{x:"CG",y:"Republic of the Congo"},{x:"RE",y:"Reunion"},{x:"RO",y:"Romania"},{x:"RU",y:"Russia"},{x:"RW",y:"Rwanda"},{x:"BL",y:"Saint Barthelemy"},{x:"SH",y:"Saint Helena"},{x:"KN",y:"Saint Kitts and Nevis"},{x:"LC",y:"Saint Lucia"},{x:"MF",y:"Saint Martin"},{x:"PM",y:"Saint Pierre and Miquelon"},{x:"VC",y:"Saint Vincent and the Grenadines"},{x:"WS",y:"Samoa"},{x:"SM",y:"San Marino"},{x:"ST",y:"Sao Tome and Principe"},{x:"SA",y:"Saudi Arabia"},{x:"SN",y:"Senegal"},{x:"RS",y:"Serbia"},{x:"CS",y:"Serbia and Montenegro"},{x:"SC",y:"Seychelles"},{x:"SL",y:"Sierra Leone"},{x:"SG",y:"Singapore"},{x:"SX",y:"Sint Maarten"},{x:"SK",y:"Slovakia"},{x:"SI",y:"Slovenia"},{x:"SB",y:"Solomon Islands"},{x:"SO",y:"Somalia"},{x:"ZA",y:"South Africa"},{x:"GS",y:"South Georgia and the South Sandwich Islands"},{x:"KR",y:"South Korea"},{x:"SS",y:"South Sudan"},{x:"ES",y:"Spain"},{x:"LK",y:"Sri Lanka"},{x:"SD",y:"Sudan"},{x:"SR",y:"Suriname"},{x:"SJ",y:"Svalbard and Jan Mayen"},{x:"SE",y:"Sweden"},{x:"CH",y:"Switzerland"},{x:"SY",y:"Syria"},{x:"TW",y:"Taiwan"},{x:"TJ",y:"Tajikistan"},{x:"TZ",y:"Tanzania"},{x:"TH",y:"Thailand"},{x:"TL",y:"Timor Leste"},{x:"TG",y:"Togo"},{x:"TK",y:"Tokelau"},{x:"TO",y:"Tonga"},{x:"TT",y:"Trinidad and Tobago"},{x:"TN",y:"Tunisia"},{x:"TR",y:"Turkey"},{x:"TM",y:"Turkmenistan"},{x:"TC",y:"Turks and Caicos Islands"},{x:"TV",y:"Tuvalu"},{x:"VI",y:"U.S. Virgin Islands"},{x:"UG",y:"Uganda"},{x:"UA",y:"Ukraine"},{x:"AE",y:"United Arab Emirates"},{x:"GB",y:"United Kingdom"},{x:"US",y:"United States"},{x:"UM",y:"United States Minor Outlying Islands"},{x:"UY",y:"Uruguay"},{x:"UZ",y:"Uzbekistan"},{x:"VU",y:"Vanuatu"},{x:"VA",y:"Vatican"},{x:"VE",y:"Venezuela"},{x:"VN",y:"Vietnam"},{x:"WF",y:"Wallis and Futuna"},{x:"EH",y:"Western Sahara"},{x:"YE",y:"Yemen"},{x:"ZM",y:"Zambia"},{x:"ZW",y:"Zimbabwe"}],states:[{x:"01",y:"Andaman And Nicobar"},{x:"02",y:"Andhra Pradesh"},{x:"30",y:"Arunachal Pradesh"},{x:"03",y:"Assam"},{x:"34",y:"Bihar"},{x:"05",y:"Chandigarh"},{x:"37",y:"Chhattisgarh"},{x:"06",y:"Dadra And Nagar Haveli"},{x:"32",y:"Daman And Diu"},{x:"07",y:"Delhi"},{x:"33",y:"Goa"},{x:"09",y:"Gujarat"},{x:"10",y:"Haryana"},{x:"11",y:"Himachal Pradesh"},{x:"12",y:"Jammu And Kashmir"},{x:"38",y:"Jharkhand"},{x:"19",y:"Karnataka"},{x:"13",y:"Kerala"},{x:"14",y:"Laccadives"},{x:"41",y:"Ladakh"},{x:"35",y:"Madhya Pradesh"},{x:"16",y:"Maharashtra"},{x:"17",y:"Manipur"},{x:"18",y:"Meghalaya"},{x:"31",y:"Mizoram"},{x:"20",y:"Nagaland"},{x:"21",y:"Odisha"},{x:"22",y:"Puducherry"},{x:"23",y:"Punjab"},{x:"24",y:"Rajasthan"},{x:"29",y:"Sikkim"},{x:"25",y:"Tamil Nadu"},{x:"40",y:"Telangana"},{x:"26",y:"Tripura"},{x:"36",y:"Uttar Pradesh"},{x:"39",y:"Uttarakhand"},{x:"28",y:"West Bengal"}]};function PlanetTable(t,a){return this.scope=t,this.ServiceRkpChart=a,that=this,this}PlanetTable.prototype.build=function(t,a){var e=buildTag("div",new Map([["id",t.id+"-planets"]]),t);return new Tabulator(e,{layout:"fitData",resizableColumns:!1,autoResize:!0,data:a,movableRows:!0,movableColumns:!0,columnHeaderVertAlign:"bottom",initialSort:[{column:"dasa.endDT",dir:"asc"}],columns:[{title:"Planets Detail",columns:[{title:"Rasi",field:"rasi",hozAlign:"left",headerVertical:!0,sortable:!0,sorter:function(t,a,e,i){return e.getData().degree360-i.getData().degree360}},{title:"Degree",field:"degree",hozAlign:"right"},{title:"Nak",field:"nakshatra",hozAlign:"right",sortable:!0,sorter:function(t,a,e,i){return e.getData().degree360-i.getData().degree360}},{title:"D9",field:"navamsa",hozAlign:"center",headerTooltip:"Navamsa Rasi"},{title:"*",field:"name",hozAlign:"left",formatter:function(t,a){var e=t.getRow().getData();return"<span style='color:red; font-weight:bold;'>"+e.abbr+e.retStr+"<sup style='color:black;'>"+getUntenantedSelfStarredStr(e)+"</sup></span>"},sortable:!0,sorter:function(t,a,e,i){return e.getData().dasa.planet_number-i.getData().dasa.planet_number},headerTooltip:"Planet"},{title:"NL",field:"nl",hozAlign:"center",headerTooltip:"Nakshatra Lord"},{title:"SL",field:"sl",hozAlign:"center",headerTooltip:"Sub Lord"},{title:"SS",field:"ssl",hozAlign:"center",headerTooltip:"Sub-Sub Lord"},{title:"CP",field:"cp",hozAlign:"right",headerTooltip:"Cusp Point(Position in cusp)"},{title:"C",field:"occCusp",hozAlign:"right",sortable:!0,sorter:function(t,a,e,i){return e.getData().occCusp===i.getData().occCusp?e.getData().cp-i.getData().cp:e.getData().occCusp-i.getData().occCusp},headerTooltip:"Occupied Cusp"},{title:"Owned Cusp(s) by:",columns:[{title:"R",field:"d1Rasi",hozAlign:"right",formatter:this.cuspDataFormatter,sorter:"array",sorterParams:{type:"min",alignEmptyValues:"top"},headerTooltip:"Rasis"},{title:"N",field:"d1Nak",hozAlign:"right",formatter:this.cuspDataFormatter,sorter:"array",sorterParams:{type:"min",alignEmptyValues:"top"},headerTooltip:"Nakshatras"},{title:"S",field:"d1Sub",hozAlign:"right",formatter:this.cuspDataFormatter,sorter:"array",sorterParams:{type:"min",alignEmptyValues:"top"},headerTooltip:"Sub"},{title:"SS",field:"d1SSub",hozAlign:"right",formatter:this.cuspDataFormatter,sorter:"array",sorterParams:{type:"min",alignEmptyValues:"top"},headerTooltip:"Sub-sub"}]},{title:"360",field:"degree360",hozAlign:"right",visible:!1,headerVertical:!0,formatter:function(t,a){return t.getValue().toFixed(2)},headerTooltip:"Rasis in Cusp"},{title:"Dasa<br> End",field:"dasa.endDT",visible:!1,formatter:this.displayDasaButton,cellClick:this.getDetailedDasa}]}]})},PlanetTable.prototype.cuspDataFormatter=function(t,a){return intArrToString(t.getValue())},function(){"use strict";function t(t,a,e){var i=this;i.ayanamsas,i.chartData,i.transitData,i.birthChartRotartion,i.countries,i.defaultCountry="IN",i.defaultState="01",i.defaultAyanamsa="True Citra",this.setChartData=function(t){i.chartData=t},this.setTransitData=function(t){i.transitData=t},this.creatNewChartFromFile=function(a){return t.get(contextPath+"/chart/"+a).then(function(t){return t},function(t){return t})},this.creatNewChart=function(a){return t.post(contextPath+"/chart/",a).then(function(t){return t},function(t){return t})},this.getCachedChartData=function(){return i.chartData},this.getCachedTransitData=function(){return i.transitData},this.initialData=function(){return t.get(contextPath+"/initialData?country="+i.defaultCountry).then(function(t){return t},function(t){return t})},this.fetchPlaceList=function(a){var e="";return a&&(e="/"+a),t.get(contextPath+"/place/list"+e).then(function(t){return t},function(t){return t})},this.searchCities=function(a,e,i,r){var n="/place/search/"+e+(i?"/"+i:"")+(r?"/"+r:"")+"?citySearch="+a;return t.get(contextPath+n).then(function(t){return t},function(t){return t})},this.getDetailedDasa=function(a,e,i){var r={planetNumber:a,startDateTime:e,passedYears:i};return t.post(contextPath+"/detaileddasa/",r).then(function(t){return t},function(t){return t})},a.info("ChartService is initialzied")}angular.module("rkpServiceModule",[]).service("ServiceRkpChart",t),t.$inject=["$http","$log","$q"]}();class ChartHousePlacement{rasiPlacement(t,a){return this.rasi={},this.rasi.x=t,this.rasi.y=a,this}planetPlacement(t,a,e,i,r,n){return this.planet={},this.planet.xStartByUnit=t,this.planet.yStartByUnit=a,this.planet.widthInUnits=e,this.planet.heightInUnits=i,this.planet.placement=r,this.planet.textAnchor=n,this}}const placements=new Map;placements.set(1,(new ChartHousePlacement).rasiPlacement(4,3.65).planetPlacement(2,0,4,3,[1,4,8,4],"middle")),placements.set(4,(new ChartHousePlacement).rasiPlacement(2,5.65).planetPlacement(0,2,4,3,[1,4,8,4],"middle")),placements.set(7,(new ChartHousePlacement).rasiPlacement(4,7.65).planetPlacement(2,4,4,3,[1,4,8,4],"middle")),placements.set(10,(new ChartHousePlacement).rasiPlacement(6,5.65).planetPlacement(4,2,4,3,[1,4,8,4],"middle")),placements.set(2,(new ChartHousePlacement).rasiPlacement(2,1.65).planetPlacement(.5,0,3,1.5,[6,4],"middle")),placements.set(12,(new ChartHousePlacement).rasiPlacement(6,1.65).planetPlacement(4.5,0,3,1.5,[6,4],"middle")),placements.set(6,(new ChartHousePlacement).rasiPlacement(2,6.35).planetPlacement(.5,6.5,3,1.5,[4,6],"middle")),placements.set(8,(new ChartHousePlacement).rasiPlacement(6,6.35).planetPlacement(4.5,6.5,3,1.5,[4,6],"middle")),placements.set(3,(new ChartHousePlacement).rasiPlacement(0,3.65).planetPlacement(0,.25,2,3,[1,3,4,3],"start")),placements.set(5,(new ChartHousePlacement).rasiPlacement(0,7.65).planetPlacement(0,4.25,2,3,[1,3,4,3],"start")),placements.set(9,(new ChartHousePlacement).rasiPlacement(7.65,7.65).planetPlacement(6,4.25,1.9,3,[1,2,4,2],"end")),placements.set(11,(new ChartHousePlacement).rasiPlacement(7.65,3.65).planetPlacement(6,.25,1.9,3,[1,2,4,2],"end"));class TraditionalChart{constructor(t,a){this.lineWidth=1,this.lineColor="black",this.width=t,this.height=a,this.widthUnit=this.width/8,this.heightUnit=this.height/8}buildCuspChart(t,a,e){var i=this.getRotatedHouseMap(e),r=this.createStructure(t),n=groupBy(a.planets,"occCusp");for(const t of a.cuspViewModals){var s,l=n[""+t.cuspNum];if(void 0!==l){s=[];for(const t of l)s.push({size:t.retStr.length>0?4:2,name:t.abbr+""+t.retStr})}else s=void 0;this.fillHouseWithRasiAndPlanets(r,i?i.get(t.cuspNum):t.cuspNum,t.cuspRisingRasi,s)}return r}buildRasiChart(t,a,e){for(var i=this.getRotatedHouseMap(e),r=this.createStructure(t),n=groupBy(a.planets,"rasiNum"),s=a.cuspViewModals[0].cuspRisingRasi,l=0;l<12;l++){var o,d=s+l,c=n[d=d>12?d%12:d];if(void 0!==c){o=[];for(const t of c)o.push({size:t.retStr.length>0?4:2,name:t.abbr+""+t.retStr})}else o=void 0;this.fillHouseWithRasiAndPlanets(r,i?i.get(l+1):l+1,d,o)}return r}buildDivisionalChart(t,a,e){for(var i=this.getRotatedHouseMap(e),r=this.createStructure(t),n=0;n<12;n++){var s=a.ascendentRasi+n;s=s>12?s%12:s;var l=a.rasiPlanets[s];void 0!==l&&(l=l.map(t=>({size:2,name:t}))),this.fillHouseWithRasiAndPlanets(r,i?i.get(n+1):n+1,s,l)}return void 0!==t&&t.appendChild(r),r}getRotatedHouseMap(t,a){return t?BirthChartRotartion.getNewMappedCuspsAfterRotation(a||1,t):null}createStructure(t){var a=buildSVGTag("svg",new Map([["height",this.height],["width",this.width],["stroke",this.lineColor],["stroke-width",this.lineWidth],["style","border: "+this.lineWidth+"px solid "+this.lineColor+";"]]),t);return buildSVGTag("line",new Map([["x1","0"],["y1","0"],["x2",this.width],["y2",this.height]]),a),buildSVGTag("line",new Map([["x1",this.width],["y1","0"],["x2","0"],["y2",this.height]]),a),buildSVGTag("line",new Map([["x1","0"],["y1",this.height/2],["x2",this.width/2],["y2","0"]]),a),buildSVGTag("line",new Map([["x1",this.width/2],["y1",this.height],["x2",this.width],["y2",this.height/2]]),a),buildSVGTag("line",new Map([["x1",this.width/2],["y1","0"],["x2",this.width],["y2",this.height/2]]),a),buildSVGTag("line",new Map([["x1","0"],["y1",this.height/2],["x2",this.width/2],["y2",this.height]]),a),buildSVGTag("line",new Map([["x1","0"],["y1",this.height/2],["x2",this.width/2],["y2",this.height]]),a),a}fillHouseWithRasiAndPlanets(t,a,e,i){this.fillRasiInCusp(t,a,e),this.fillPlanetsInCusp(t,a,i)}fillPlanetsInCusp(t,a,e){var i;if(void 0!==e&&e.length>0){var r=placements.get(a).planet.xStartByUnit*this.widthUnit,n=placements.get(a).planet.yStartByUnit*this.heightUnit,s=placements.get(a).planet.widthInUnits*this.widthUnit,l=placements.get(a).planet.heightInUnits*this.heightUnit,o=[].concat(placements.get(a).planet.placement),d=placements.get(a).planet.textAnchor;if(i=buildSVGTag("svg",new Map([["x",r],["y",n],["width",s],["height",l]]),t),"string"==typeof e)buildSVGTag("text",new Map([["x","50%"],["y","20%"],["dominant-baseline","middle"],["text-anchor","middle"]]),i,e);else{var c=groupBy(e,"size"),u=c[4],h=c[2],p=Array(o.length).join(".").split(".");void 0!==u&&u.length>0&&this.fillText(u,2,o,p),void 0!==h&&h.length>0&&this.fillText(h,1,o,p);for(var m=0;m<p.length;m++)buildSVGTag("text",new Map([["x","middle"===d?"50%":"start"===d?"0%":"100%"],["y",100*(m+1)/(p.length+1)+"%"],["dominant-baseline","middle"],["text-anchor",d]]),i,p[m])}}return i}fillText(t,a,e,i){if(void 0!==t||t.length>0)for(const n of t)for(var r=0;r<e.length;){if(e[r]>=a){i[r]=""===i[r]?n.name:i[r]+" "+n.name,e[r]=e[r]-a;break}r++}}fillRasiInCusp(t,a,e){var i=placements.get(a).rasi.x*this.widthUnit,r=placements.get(a).rasi.y*this.heightUnit;return buildSVGTag("text",new Map([["x",i],["y",r],["class",e+"-traditional-chart-rasi-text"]]),t,e)}}class ChartDrawer{constructor(t,a,e,i){this.scope=e,this.compile=i,this.traditionalChart=new TraditionalChart(t,a)}rotateIndividualChart(t,a,e){if("rasi"==t)(i=document.getElementById(e)).innerHTML="",this.traditionalChart.buildRasiChart(i,a,this.scope[e+"RotatonModel"]);else if("cusp"==t){var i;(i=document.getElementById(e)).innerHTML="",this.traditionalChart.buildCuspChart(i,a,this.scope[e+"RotatonModel"])}else{var r=a.divisionalCharts,n=document.getElementById("div_chart-"+t);n.innerHTML="",this.traditionalChart.buildDivisionalChart(n,r[t],this.scope["divChart"+t+"rotatonModel"])}}buildDivisionalCharts(t,a){var e=a.divisionalCharts;if(void 0!==e&&0!==e.length){for(var i=buildTag("table",new Map([["class","border align-top m-0 p-0 w-100"]]),t),r=Math.ceil(e.length/2),n=0;n<r;n++)for(var s=buildTag("tr",new Map([["class","m-0 p-0 w-100"]]),i),l=0;l<2;l++){var o=buildTag("td",new Map([["style","border-width: 5px"],["class","border table text-center align-middle m-0 px-2 py-2 w-50"]]),s),d=2*n+l;if(e.length>=d+1){var c=buildTag("div",new Map([["class","d-flex justify-content-between"]]),o),u=buildTag("span",new Map([["class","pr-1"]]),c);buildTag("strong",new Map([["class","float-left"],["style","color:blue;"]]),u,"<u>D"+e[d].chartType+" </u>"),buildTag("select",new Map([["id",d+"divChartRotationSelect"],["ng-options","n for n in cuspArray"],["ng-model","divChart"+d+"rotatonModel"],["ng-init","divChart"+d+"rotatonModel=1"],["ng-change",'rotateIndividualChart("'+d+'")'],["class","custom-select form-control"],["required","true"]]),u);var h=buildTag("div",new Map([["class","div_chart p-0"],["id","div_chart-"+d]]),c);this.traditionalChart.buildDivisionalChart(h,e[d])}}return this.compile(t)(this.scope),t}}buildKPCharts(t,a){var e=buildTag("table",new Map([["class","border align-top m-0 p-0 float-left w-100"]]),t),i=buildTag("tr",new Map([["class","m-0 p-0"]]),e),r=buildTag("td",new Map([["class","border w-50 h-100 m-0 p-0 align-middle"]]),i);buildRadixChart(buildTag("div",new Map([["class","rkp_chart"],["id","rkp_chart"]]),r),a);var n=buildTag("td",new Map([["class","align-top border w-50 h-100 m-0 p-0"]]),i);return this.buildBasicCharts(n,a,!0),this.compile(t)(this.scope),t}buildBasicCharts(t,a,e,i){var r=buildTag("table",new Map([["class","m-0 p-0 w-100 h-100"]]),t),n=buildTag("tr",new Map([["class","m-0 pb-1 h-50 w-100 border-bottom"]]),r),s=buildTag("td",new Map([["class","text-center align-middle px-3 py-3"]]),n);this.buildChartWithRotateSelect(e,a,s,"rasiChart","rasi","Rasi");var l=buildTag("tr",new Map([["class","m-0 pt-1 h-50 w-100"]]),r),o=buildTag("td",new Map([["class","text-center align-middle px-3 py-3"]]),l);if(this.buildChartWithRotateSelect(e,a,o,"cuspChart","cusp","Cusp"),i){var d=buildTag("tr",new Map([["class","m-0 pt-1 h-50 w-100"]]),r),c=buildTag("td",new Map([["class","text-center align-middle px-3 py-3"]]),d);this.buildChartWithRotateSelect(e,i,c,"D9","divisional","D9")}}buildChartWithRotateSelect(t,a,e,i,r,n){var s=buildTag("div",new Map([["class","d-flex justify-content-between"]]),e),l=buildTag("span",new Map([["class","pr-1"]]),s);buildTag("strong",new Map([["class","float-left"],["style","color:blue;"]]),l,"<u>"+n+"</u>"),t&&buildTag("select",new Map([["id",i+"RotationSelect"],["ng-options","n for n in cuspArray"],["ng-model",i+"RotatonModel"],["ng-init",i+"RotatonModel=1"],["ng-change",'rotateIndividualChart("'+r+'", "'+i+'")'],["class","custom-select form-control"],["required","true"]]),l);var o=buildTag("span",new Map([["class","pr-1"]]),s),d=buildTag("div",new Map([["class","p-0"],["id",i]]),o);"rasi"==r?this.traditionalChart.buildRasiChart(d,a):"cusp"==r?this.traditionalChart.buildCuspChart(d,a):"divisional"==r&&this.traditionalChart.buildDivisionalChart(d,a)}}function buildKPCharts(t,a,e,i){var r=buildTag("table",new Map([["class","border align-top m-0 p-0 float-left w-100"]]),t),n=buildTag("tr",new Map([["class","m-0 p-0"]]),r),s=buildTag("td",new Map([["class","border w-50 h-100 m-0 p-0 align-middle"]]),n),l=buildTag("div",new Map([["class","rkp_chart"],["id","rkp_chart"]]),s),o=buildTag("td",new Map([["class","align-top border w-50 h-100 m-0 p-0"]]),n),d=buildTag("table",new Map([["class","m-0 p-0 w-100 h-100"]]),o),c=buildTag("tr",new Map([["class","m-0 pb-1 h-50 w-100 border-bottom"]]),d),u=buildTag("td",new Map([["class","text-center align-middle px-3 py-3"]]),c),h=buildTag("div",new Map([["class","d-flex justify-content-between"]]),u),p=buildTag("span",new Map([["class","pr-1"]]),h);buildTag("strong",new Map([["class","float-left"],["style","color:blue;"]]),p,"<u>Rasi</u>"),buildTag("select",new Map([["id","rasiChartRotationSelect"],["ng-options","n for n in cuspArray"],["ng-model","rasiChartRotatonModel"],["ng-init","rasiChartRotatonModel=1"],["ng-change","rotateRasiChart()"],["class","custom-select form-control"],["required","true"]]),p);var m=buildTag("span",new Map([["class","pr-1"]]),h),g=buildTag("div",new Map([["class","rasi_chart p-0"],["id","rasi_chart"]]),m),y=buildTag("tr",new Map([["class","m-0 pt-1 h-50 w-100"]]),d),b=buildTag("td",new Map([["class","text-center align-middle px-3 py-3"]]),y),C=buildTag("div",new Map([["class","d-flex justify-content-between"]]),b),v=buildTag("span",new Map([["class","pr-1"]]),C);buildTag("strong",new Map([["class","float-left"],["style","color:blue;"]]),v,"<u>Cusp</u>"),buildTag("select",new Map([["id","cuspChartRotationSelect"],["ng-options","n for n in cuspArray"],["ng-model","cuspChartRotatonModel"],["ng-init","cuspChartRotatonModel=1"],["ng-change","rotateCuspChart()"],["class","custom-select form-control"],["required","true"]]),v);var f=buildTag("span",new Map([["class","pr-1"]]),C),T=buildTag("div",new Map([["class","cusp_chart p-0"],["id","cusp_chart"]]),f);buildRadixChart(l,a);var x=new TraditionalChart(400,250);return x.buildRasiChart(g,a),x.buildCuspChart(T,a),i(t)(e),t}function buildRadixChart(t,a){var e,i=a.cuspViewModals.map(t=>t.startDegree360),r={};for(e of a.planets)r[e.planet]=[e.degree360,e.velocity];var n={planets:r,cusps:i};new astrology.Chart(t.id,550,550).radix(n).aspects()}function buildTag(t,a,e,i){var r=document.createElement(t);if(void 0!==a)for(var[n,s]of a)r.setAttribute(n,s);return void 0!==i&&(r.innerHTML=i),void 0!==e&&e.appendChild(r),r}function buildSVGTag(t,a,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg",t);if(void 0!==a)for(var[n,s]of a)r.setAttribute(n,s);return void 0!==i&&(r.innerHTML=i),void 0!==e&&e.appendChild(r),r}function titleCase(t){if(t){for(var a=t.toLowerCase().split(" "),e=0;e<a.length;e++)a[e]=a[e].charAt(0).toUpperCase()+a[e].slice(1);t=a.join(" ")}return t}function formatDate(t){var a=t.getFullYear(),e=t.getMonth()+1,i=t.getDate(),r=t.getHours(),n=t.getMinutes(),s=t.getSeconds();return a+"-"+(e>9?e:"0"+e)+"-"+(i>9?i:"0"+i)+"T"+((r>9?r:"0"+r)+":"+(n>9?n:"0"+n)+":"+(s>9?s:"0"+s))}function formatDate1(t){return t.toLocaleString("en-CA",{hour12:!1}).replace(", ","T")}function adjustForTimezone(t,a){return t.setTime(t.getTime()+1e3*a*60*60),t}function getTimeZoneHour(t){return t.getTimezoneOffset()/-60}function generateRandomInteger(t,a){return Math.floor(t+Math.random()*(a+1-t))}var getLocalLocationPositionPromise=function(t){return navigator.geolocation.getCurrentPosition(function(){},function(){},{}),new Promise(function(a,e){navigator.geolocation.getCurrentPosition(a,e,t)})};function getUntenantedSelfStarredStr(t){var a=t.unTenanted?"U":"",e=t.selfStarred?"S":"",i="";return"U"===a&&"S"===e&&(i=", "),a+i+e}function convertToDMS(t){function a(t){t=Math.abs(t);var a=Math.floor(t);t-=a,t*=60;var e=Math.floor(t);return t-=e,a+":"+e+":"+(t*=60).toFixed(2)}var e=t.longitude>0?"E":"W",i=t.latitude>0?"N":"S";return{longitude:a(t.longitude)+e,latitude:a(t.latitude)+i}}var groupBy=function(t,a){return t.reduce(function(t,e){return(t[e[a]]=t[e[a]]||[]).push(e),t},{})},groupByWithValue=function(t,a,e){return t.reduce(function(t,i){return(t[i[a]]=t[i[a]]||[]).push(i[e]),t},{})};function intArrToString(t){return t?t.join(", "):""}const birthChartsfieldsToVlidate=["horaryNumber","name","date","longitude","latitude","timezone"],transitChartsfieldsToVlidate=["date","longitude","latitude","timezone"],citySearchfieldsToVlidate=["citySearch"];function BirthChartValidation(t,a){return this.scope=t,this.ServiceRkpChart=a,this}function isStringNullOrEmpty(t){return!t||0===(""+t).trim().length}BirthChartValidation.displayErrorMessages=function(t,a,e){for(key of(e||(e="transit"==t?transitChartsfieldsToVlidate:birthChartsfieldsToVlidate),e))a.hasOwnProperty(key)?BirthChartValidation.setInValidClass(t+key+"GrpDiv",t+key+"Input",a[key]):BirthChartValidation.setValidClass(t+key+"GrpDiv",t+key+"Input")},BirthChartValidation.validateAndDisplayMessage=function(t,a,e){e||(e="transit"==t?transitChartsfieldsToVlidate:birthChartsfieldsToVlidate);var i=BirthChartValidation.validateFields(a,e);return BirthChartValidation.displayErrorMessages(t,i,e),!(i&&Object.keys(i).length>0)},BirthChartValidation.validateFields=function(t,a){var e={};for(field of a){var i=BirthChartValidation.validateField(field,t);i&&(e[field]=i)}return 0==e.size&&(e=void 0),e},BirthChartValidation.validateField=function(t,a){var e;switch(t){case"horaryNumber":e=BirthChartValidation.validateHoraryNumber(a);break;case"name":e=BirthChartValidation.validateName(a);break;case"date":e=BirthChartValidation.validateDate(a);break;case"longitude":e=BirthChartValidation.validateLongitude(a);break;case"latitude":e=BirthChartValidation.validateLatitude(a);break;case"timezone":e=BirthChartValidation.validateTimezone(a);break;case"citySearch":e=BirthChartValidation.validateCitySearch(a)}return e},BirthChartValidation.setValidClass=function(t,a){var e=document.getElementById(a);e.classList.remove("is-valid"),e.classList.remove("is-invalid"),e.classList.add("is-valid");var i="invalid-feedback"+t,r=document.getElementById(i);r&&r.remove()},BirthChartValidation.setInValidClass=function(t,a,e){var i=document.getElementById(a);if(i.classList.remove("is-valid"),i.classList.remove("is-invalid"),i.classList.add("is-invalid"),e){var r=document.getElementById(t),n="invalid-feedback"+t,s=document.getElementById(n);s?s.innerHTML=e:buildTag("div",new Map([["id",n],["class","invalid-feedback"]]),r,e)}},BirthChartValidation.validateHoraryNumber=function(t){var a;return t.isHorayChart&&(t.horaryNumber&&t.horaryNumber>0&&t.horaryNumber<250||(a="Enter number between 1 to 249")),a},BirthChartValidation.validateName=function(t){var a;return isStringNullOrEmpty(t.name)?a="Enter Name":t.name.length>20&&(a="Name can not be more than 20 characters"),a},BirthChartValidation.validateDate=function(t){var a;return t.date instanceof Date||(a="Enter Valid Date and Time"),a},BirthChartValidation.validateLongitude=function(t){var a;return isStringNullOrEmpty(t.longitude)&&(a="Enter Valid Longitude"),a},BirthChartValidation.validateLatitude=function(t){var a;return isStringNullOrEmpty(t.latitude)&&(a="Enter Valid Latitude"),a},BirthChartValidation.validateTimezone=function(t){var a;return isStringNullOrEmpty(t.timezone)&&(a="Enter Valid Timezone"),a},BirthChartValidation.validateCitySearch=function(t){var a;return t||(a="Search city can not be blank"),a};